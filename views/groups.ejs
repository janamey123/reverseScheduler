<% include partials/header.ejs %>

<div class="topnav">
    <a href="/dashboard">Your personal schedule</a>
    <a href="/account">Your account</a>
    <a id="groups" href="/groups">My groups</a>
</div>

<br><br>
<h3>My groups</h3>
<br>

<table class="centered">
    <tr id="table-header">
        <td><strong>Groupname</strong></td>
        <td><strong>Groupmember</strong></td>
    </tr>
    <tr class="table-row">
        <td>
            <div id="group"></div>
        </td>
        <td>
            <div id="member"></div>
        </td>
    </tr>
</table>


<div id="member"></div>


<div id="message"></div>
<br><br>
<script>
    $(document).ready(function () {

        getUsersGroups();

        function getUsersGroups() {
            $.ajax({
                method: "GET",
                url: "/getUsersGroups",
                dataType: "json",
                success: function (result, status) {
                    let groupKey = "";
                    let memberKey = "";

                    $("#message").hide();

                    if (result.length == 0) {
                        $("#message").attr("class", "text-info");
                        $("#message").html("You currently don't have any groups.")
                        $("#message").show();
                    } else {
                        for (let i = 0; i < result.length; i++) {
                            $("#group").append(`<div name="group" id="group${i}">`);
                            $("#member").append(`<div name="member" id="member${i}"</div>`);
                        }

                        for (let i = 0; i < result.length; i++) {
                            groupKey = "\#group" + i;
                            $(groupKey).html(result[i].groupname);
                            memberKey = "\#member" + i;
                            $(memberKey).html(result[i].username);

                        }
                    }
                }
            });//ajax
        }//getUsersEvents
    });//ready

    var popupWindow = null;

    function centeredPopup(url, winName, w, h, scroll) {
        LeftPosition = (screen.width) ? (screen.width - w) / 2 : 0;
        TopPosition = (screen.height) ? (screen.height - h) / 2 : 0;
        settings =
            'height=' + h + ',width=' + w + ',top=' + TopPosition + ',left=' + LeftPosition + ',scrollbars=' + scroll + ',resizable'
        popupWindow = window.open(url, winName, settings)
    }
</script>
<% include partials/footer %>
